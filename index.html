<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>Photo Tagger (Top-Kï¼ˆä¸Šä½ï¼‰)</title>
  <link rel="manifest" href="./manifest.json" />
  <meta name="theme-color" content="#111111" />
  <style>
    :root{
      --bg:#0b0b0c; --fg:#f2f2f2; --muted:rgba(255,255,255,.65);
      --panel:rgba(255,255,255,.06); --border:rgba(255,255,255,.12);
      --btn:rgba(255,255,255,.08); --btnb:rgba(255,255,255,.14);
    }
    html,body{height:100%;margin:0;background:var(--bg);color:var(--fg);
      font-family:system-ui,-apple-system,Segoe UI,Roboto,"Noto Sans JP",sans-serif;}
    #wrap{position:fixed;inset:0;display:grid;grid-template-rows:auto 1fr auto;gap:10px;
      padding:calc(10px + env(safe-area-inset-top)) calc(10px + env(safe-area-inset-right)) calc(10px + env(safe-area-inset-bottom)) calc(10px + env(safe-area-inset-left));box-sizing:border-box;}
    .panel{background:var(--panel);border:1px solid var(--border);border-radius:14px;padding:10px;}
    .bar{display:flex;gap:8px;flex-wrap:wrap;align-items:center;justify-content:space-between;}
    .row{display:flex;gap:8px;flex-wrap:wrap;align-items:center;}
    button,select,input{
      background:var(--btn);color:var(--fg);border:1px solid var(--btnb);
      border-radius:12px;padding:10px 12px;font-size:14px;
    }
    button{cursor:pointer}
    button:active{transform:translateY(1px)}
    button:disabled{opacity:.5;cursor:not-allowed}
    #stage{position:relative;display:grid;place-items:center;border-radius:14px;overflow:hidden;background:#000;width:100%;max-height:55vh;min-height:240px;aspect-ratio:4/3;}
@supports not (aspect-ratio: 1 / 1){ #stage{height:45vh;} }
    video,canvas{width:100%;height:100%;object-fit:cover;background:#000}
    canvas{display:none}
    #tags{max-height:30vh;overflow:auto}
    .tag{display:flex;align-items:center;justify-content:space-between;gap:10px;padding:10px 0;
      border-bottom:1px solid rgba(255,255,255,.08);}
    .label{font-size:16px;font-weight:700;line-height:1.2;cursor:pointer}
    .score{color:var(--muted);font-size:12px;white-space:nowrap}
    .muted{color:var(--muted);font-size:12px}
    .pill{display:inline-block;padding:2px 8px;border:1px solid rgba(255,255,255,.18);border-radius:999px;color:var(--muted)}
  
    /* multi-language tag lines */
    .tag{display:block}
    .tline{display:flex;align-items:center;justify-content:space-between;gap:10px;padding:6px 0}
    .tleft{display:flex;align-items:baseline;gap:8px;min-width:0}
    .tlang{font-size:12px;color:var(--muted);white-space:nowrap}
    .tmain{font-size:15px;font-weight:700;line-height:1.2;cursor:pointer;min-width:0;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}
    .tgloss{font-size:12px;color:var(--muted);white-space:nowrap;cursor:pointer}
    .tright{display:flex;align-items:center;gap:8px;white-space:nowrap}
    .sbtn{padding:8px 10px;border-radius:10px}
    
  
    html{ -webkit-text-size-adjust:100%; text-size-adjust:100%; }


    /* --- overflow safety (prevents horizontal spill on some photos/tags) --- */
    body{overflow-x:hidden;}
    #wrap{overflow-x:hidden;}
    header,main,footer,.panel,.bar,.row{max-width:100%;}
    button,select,input{max-width:100%;}
    .panel{overflow:hidden;}
    .tag{display:block;width:100%;overflow:hidden;}
    .tline{flex-wrap:wrap;}
    .tleft{min-width:0;flex:1 1 auto;}
    .tmain{min-width:0;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;}
    .tgloss{min-width:0;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;max-width:60vw;}
    

    #file{position:absolute;left:-9999px;width:1px;height:1px;opacity:0;}

    input[type="file"]{display:none}

    /* Touch-friendly UI */
    button,select,input{min-height:44px; line-height:1.2; touch-action:manipulation;}
    button{display:inline-flex;align-items:center;justify-content:center;gap:8px;}
    @media (pointer:coarse){
      button,select,input{font-size:16px;padding:14px 16px;border-radius:14px;}
      .panel{border-radius:16px}
      #wrap{gap:12px}
      .muted{font-size:13px}
      .tmain{font-size:16px}
      .score{font-size:12px}
    }
    @media (max-width: 640px){
      #wrap{padding:12px}
      .bar{flex-direction:column;align-items:stretch}
      .row{width:100%}
      .row.controls{display:grid;grid-template-columns:1fr 1fr;gap:10px}
      .row.controls button{width:100%}
      #stage{max-height:52vh;min-height:260px}
      #tags{max-height:34vh}
    }
</style>
</head>
<body>
  <div id="wrap">
    <div class="panel">
      <div class="bar">
        <div class="row controls">
          <button id="btnCapture">ğŸ“¸ æ’®å½± / Capture</button>
          <button id="btnRetake" style="display:none">â†©ï¸ æ’®ã‚Šç›´ã—</button>
          <button id="btnAnalyze" disabled>ğŸ” ã‚¿ã‚°è§£æ / Analyze</button>
          <button id="btnPick" type="button">ğŸ–¼ ç”»åƒ</button>
          <input id="file" type="file" accept="image/*" />
        </div>
        <div class="row">
          <span class="muted">Languages</span>
          <span class="pill">ğŸ‡¯ğŸ‡µ JA</span><span class="pill">ğŸ‡¨ğŸ‡³ ZH</span><span class="pill">ğŸ‡°ğŸ‡· KO</span><span class="pill">ğŸ‡ºğŸ‡¸ EN</span>
          <span class="muted">Top-Kï¼ˆä¸Šä½ï¼‰</span>
          <select id="topk">
            <option selected>10</option>
            <option>30</option>
            <option>50</option>
            <option>80</option>
          </select>
        </div>
      </div>
      <div class="muted" id="status">ã‚«ãƒ¡ãƒ©èµ·å‹•ä¸­â€¦ï¼ˆè¨±å¯ãŒå¿…è¦ã§ã™ï¼‰</div>
    </div>

    <div id="stage" class="panel" style="padding:0">
      <video id="cam" playsinline autoplay muted></video>
      <canvas id="shot"></canvas>
    </div>

    <div class="panel">
      <div class="bar" style="margin-bottom:6px">
        <div class="row">
          <b>Tags</b>
          <span class="muted">ï¼ˆã‚¿ãƒƒãƒ—ã§ç™ºéŸ³ï¼‰</span>
        </div>
</div>
      <div id="tags" class="muted">ã¾ã è§£æã—ã¦ã„ã¾ã›ã‚“ã€‚</div>
      <div class="muted" style="margin-top:8px">
        â€» ç™ºéŸ³ã¯ç«¯æœ«ã®TTSéŸ³å£°ã«ä¾å­˜ã—ã¾ã™ï¼ˆiPhone/Androidã§å·®ãŒå‡ºã¾ã™ï¼‰ã€‚
      </div>
    </div>
  </div>

  <script type="module" src="./app.js"></script>
</body>
</html>
